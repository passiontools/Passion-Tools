<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Password Generator - PassionTools</title>
    <style>
        /* ==========================================================================
           üé® GLOBAL TYPOGRAPHY & THEME VARIABLES
           ========================================================================== */
        :root {
            /* Light Theme */
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
            --input-bg: #f8fafc;
            --input-border: #cbd5e1;
            --accent: #ef4444;
            --accent-hover: #dc2626;
            --bulb-hover: #0f172a;
            --bulb-active: #0f172a;
            --modern-blue: #3b82f6;
            --modern-blue-dark: #2563eb;
            
            /* Strength Colors */
            --strength-weak: #ef4444;
            --strength-fair: #f59e0b;
            --strength-good: #3b82f6;
            --strength-strong: #10b981;

            /* Footer */
            --footer-bg: #111827;
            --footer-text: #94a3b8;
        }

        [data-theme="dark"] {
            /* Dark Theme */
            --bg-color: #020617;
            --card-bg: #111827;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --border-color: #334155;
            --input-bg: #1e293b;
            --input-border: #475569;
            --bulb-hover: #f8fafc;
            --bulb-active: #fbbf24;

            /* Strength Colors */
            --strength-weak: #f87171;
            --strength-fair: #fbbf24;
            --strength-good: #60a5fa;
            --strength-strong: #34d399;

            /* Footer */
            --footer-bg: #020617;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* ==========================================================================
           üî∑ HEADER
           ========================================================================== */
        header {
            position: sticky;
            top: 0;
            height: 70px;
            width: 100%;
            background-color: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .header-container {
            width: 100%;
            max-width: 900px;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 800;
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
            text-decoration: none;
        }

        .logo-passion { color: var(--text-main); }
        .logo-tools {
            background: linear-gradient(135deg, #ef4444, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-link {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-muted);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-link:hover { color: var(--accent); }

        .vertical-divider {
            height: 20px;
            width: 1px;
            background-color: var(--border-color);
        }

        .theme-toggle {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            border-radius: 6px;
        }

        .theme-toggle svg { width: 20px; height: 20px; }
        .theme-toggle:hover { color: var(--bulb-hover); }
        [data-theme="dark"] .theme-toggle svg { color: var(--bulb-active); }

        /* ==========================================================================
           üì¶ MAIN TOOL SECTION
           ========================================================================== */
        main {
            flex: 1;
            display: flex;
            justify-content: center;
            padding: 40px 20px;
            width: 100%;
        }

        .tool-container {
            width: 100%;
            max-width: 700px; /* Slimmer max-width for password tool */
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            padding: 30px;
            border: 1px solid var(--border-color);
        }

        .card h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-main);
            text-align: center;
            margin-bottom: 25px;
        }

        /* üîë DISPLAY SECTION */
        .password-display-container {
            position: relative;
            margin-bottom: 25px;
        }

        .password-display {
            width: 100%;
            background-color: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 20px 60px 20px 20px;
            font-size: 24px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            color: var(--modern-blue);
            font-weight: 700;
            word-break: break-all;
            text-align: center;
            min-height: 74px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: border-color 0.3s;
        }

        .password-display.copied {
            border-color: var(--strength-strong);
        }

        .btn-copy-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .btn-copy-icon:hover {
            background-color: var(--border-color);
            color: var(--text-main);
        }

        /* üõ°Ô∏è STRENGTH METER */
        .strength-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding: 15px 20px;
            background-color: var(--input-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .strength-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .strength-meter {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .strength-text {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-main);
        }

        .strength-bars {
            display: flex;
            gap: 4px;
        }

        .bar {
            width: 8px;
            height: 20px;
            border-radius: 2px;
            background-color: var(--border-color);
            transition: background-color 0.3s ease;
        }

        /* ‚öôÔ∏è CONTROLS SECTION */
        .controls-group {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }

        .length-control {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .length-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .length-header label {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-main);
        }

        .length-input {
            width: 60px;
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid var(--input-border);
            background-color: var(--input-bg);
            color: var(--text-main);
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            outline: none;
        }

        .length-input:focus {
            border-color: var(--modern-blue);
        }

        /* Custom Range Slider */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]:focus {
            outline: none;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: var(--border-color);
            border-radius: 4px;
        }
        input[type=range]::-webkit-slider-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: var(--modern-blue);
            cursor: pointer;
            -webkit-appearance: none;
            margin-top: -7px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.15);
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        @media (min-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            user-select: none;
            padding: 8px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .checkbox-wrapper:hover {
            background-color: var(--input-bg);
        }

        .checkbox-wrapper input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--modern-blue);
            cursor: pointer;
        }

        .checkbox-wrapper label {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-main);
            cursor: pointer;
            flex: 1;
        }

        /* üîµ BUTTONS */
        .btn-primary {
            background: linear-gradient(135deg, var(--modern-blue), var(--modern-blue-dark));
            color: #ffffff;
            border: none;
            padding: 16px 24px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.35);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }

        /* üîª FOOTER */
        footer {
            background-color: var(--footer-bg);
            color: var(--footer-text);
            text-align: center;
            padding: 30px 20px;
            font-size: 14px;
            margin-top: auto;
        }
    </style>
</head>
<body>

    <header>
        <div class="header-container">
            <a href="index.html" class="logo" aria-label="PassionTools Home">
                <span class="logo-passion">Passion</span><span class="logo-tools">Tools</span>
            </a>
            <div class="header-controls">
                <a href="index.html" class="nav-link" aria-label="Back to Tools">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                    Back to Tools
                </a>
                <div class="vertical-divider"></div>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle Theme">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.9 1.2 1.5 1.5 2.5"/>
                        <path d="M9 18h6"/>
                        <path d="M10 22h4"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <main>
        <div class="tool-container">
            <div class="card">
                <h1>Generate Secure Password</h1>
                
                <div class="password-display-container">
                    <div class="password-display" id="passwordDisplay">Generating...</div>
                    <button class="btn-copy-icon" id="copyBtn" aria-label="Copy password" title="Copy to clipboard">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                    </button>
                </div>

                <div class="strength-section">
                    <div class="strength-label">Password Strength</div>
                    <div class="strength-meter">
                        <span class="strength-text" id="strengthText">Good</span>
                        <div class="strength-bars">
                            <div class="bar" id="bar1"></div>
                            <div class="bar" id="bar2"></div>
                            <div class="bar" id="bar3"></div>
                            <div class="bar" id="bar4"></div>
                        </div>
                    </div>
                </div>

                <div class="controls-group">
                    <div class="length-control">
                        <div class="length-header">
                            <label for="lengthSlider">Character Length</label>
                            <input type="number" id="lengthInput" class="length-input" value="16" min="4" max="128">
                        </div>
                        <input type="range" id="lengthSlider" min="4" max="128" value="16">
                    </div>

                    <div class="options-grid">
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="chkUpper" checked>
                            <span>Include Uppercase Letters (A-Z)</span>
                        </label>
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="chkLower" checked>
                            <span>Include Lowercase Letters (a-z)</span>
                        </label>
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="chkNumbers" checked>
                            <span>Include Numbers (0-9)</span>
                        </label>
                        <label class="checkbox-wrapper">
                            <input type="checkbox" id="chkSymbols" checked>
                            <span>Include Symbols (!@#$...)</span>
                        </label>
                    </div>
                </div>

                <button class="btn-primary" id="generateBtn">
                    Generate Password
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="23 4 23 10 17 10"></polyline>
                        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                    </svg>
                </button>

            </div>
        </div>
    </main>

    <footer>
        ¬© 2026 Passion Tools. Secure client-side processing.
    </footer>

    <script>
        /**
         * PassionTools Password Generator
         * Utilizes Crypto API for secure randomness.
         */

        // --- 1. THEME MANAGEMENT ---
        const themeToggleBtn = document.getElementById('themeToggle');
        const htmlElement = document.documentElement;
        const savedTheme = localStorage.getItem('passionTheme') || 'light';
        htmlElement.setAttribute('data-theme', savedTheme);

        themeToggleBtn.addEventListener('click', () => {
            const currentTheme = htmlElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            htmlElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('passionTheme', newTheme);
        });

        // --- 2. DOM ELEMENTS ---
        const display = document.getElementById('passwordDisplay');
        const copyBtn = document.getElementById('copyBtn');
        const generateBtn = document.getElementById('generateBtn');
        
        const lengthSlider = document.getElementById('lengthSlider');
        const lengthInput = document.getElementById('lengthInput');
        
        const chkUpper = document.getElementById('chkUpper');
        const chkLower = document.getElementById('chkLower');
        const chkNumbers = document.getElementById('chkNumbers');
        const chkSymbols = document.getElementById('chkSymbols');
        
        const strengthText = document.getElementById('strengthText');
        const bars = [
            document.getElementById('bar1'),
            document.getElementById('bar2'),
            document.getElementById('bar3'),
            document.getElementById('bar4')
        ];

        // --- 3. CHARACTER SETS ---
        const CHARS = {
            upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
            lower: "abcdefghijklmnopqrstuvwxyz",
            numbers: "0123456789",
            symbols: "!@#$%^&*()_+~`|}{[]:;?><,./-="
        };

        // --- 4. SECURE RANDOM GENERATION LOGIC ---
        // Generates a cryptographically secure random number between 0 and max-1
        function getSecureRandomInt(max) {
            const randomBuffer = new Uint32Array(1);
            window.crypto.getRandomValues(randomBuffer);
            // Floating point representation [0.0, 1.0)
            const randomFloat = randomBuffer[0] / (0xffffffff + 1);
            return Math.floor(randomFloat * max);
        }

        function generatePassword() {
            const length = parseInt(lengthInput.value, 10);
            
            let charPool = "";
            let guaranteedChars = [];

            // Build pool and ensure at least one character from each selected category
            if (chkUpper.checked) {
                charPool += CHARS.upper;
                guaranteedChars.push(CHARS.upper[getSecureRandomInt(CHARS.upper.length)]);
            }
            if (chkLower.checked) {
                charPool += CHARS.lower;
                guaranteedChars.push(CHARS.lower[getSecureRandomInt(CHARS.lower.length)]);
            }
            if (chkNumbers.checked) {
                charPool += CHARS.numbers;
                guaranteedChars.push(CHARS.numbers[getSecureRandomInt(CHARS.numbers.length)]);
            }
            if (chkSymbols.checked) {
                charPool += CHARS.symbols;
                guaranteedChars.push(CHARS.symbols[getSecureRandomInt(CHARS.symbols.length)]);
            }

            // Fallback if nothing selected (should be prevented by UI, but safe catch)
            if (charPool === "") {
                charPool = CHARS.lower;
                chkLower.checked = true;
                guaranteedChars.push(CHARS.lower[getSecureRandomInt(CHARS.lower.length)]);
            }

            let password = "";
            
            // Fill the rest of the password randomly from the combined pool
            const remainingLength = length - guaranteedChars.length;
            for (let i = 0; i < remainingLength; i++) {
                password += charPool[getSecureRandomInt(charPool.length)];
            }

            // Combine and Shuffle (Fisher-Yates) the password so guaranteed chars aren't always first
            let passArray = password.split('').concat(guaranteedChars);
            for (let i = passArray.length - 1; i > 0; i--) {
                const j = getSecureRandomInt(i + 1);
                [passArray[i], passArray[j]] = [passArray[j], passArray[i]];
            }

            // If requested length was somehow smaller than selected sets (e.g. len 3, 4 sets)
            // Truncate it to requested length safely
            password = passArray.join('').substring(0, length);

            display.textContent = password;
            display.classList.remove('copied');
            updateStrengthMeter(length, [chkUpper.checked, chkLower.checked, chkNumbers.checked, chkSymbols.checked]);
        }

        // --- 5. STRENGTH CALCULATION ---
        function updateStrengthMeter(length, activeSets) {
            const activeCount = activeSets.filter(Boolean).length;
            
            let strengthScore = 0;
            
            if (length > 7) strengthScore++;
            if (length > 11) strengthScore++;
            if (length >= 16) strengthScore++;
            
            if (activeCount >= 2) strengthScore++;
            if (activeCount >= 3) strengthScore++;
            if (activeCount === 4) strengthScore++;

            // Reset all bars
            bars.forEach(bar => {
                bar.style.backgroundColor = 'var(--border-color)';
            });

            let text = "";
            let color = "";

            if (length < 8 || strengthScore < 3) {
                text = "Weak";
                color = "var(--strength-weak)";
                bars[0].style.backgroundColor = color;
            } 
            else if (strengthScore >= 3 && strengthScore < 5) {
                text = "Fair";
                color = "var(--strength-fair)";
                bars[0].style.backgroundColor = color;
                bars[1].style.backgroundColor = color;
            } 
            else if (strengthScore >= 5 && strengthScore < 7) {
                text = "Good";
                color = "var(--strength-good)";
                bars[0].style.backgroundColor = color;
                bars[1].style.backgroundColor = color;
                bars[2].style.backgroundColor = color;
            } 
            else {
                text = "Strong";
                color = "var(--strength-strong)";
                bars.forEach(bar => bar.style.backgroundColor = color);
            }

            strengthText.textContent = text;
            strengthText.style.color = color;
        }

        // --- 6. EVENT LISTENERS ---
        // Sync Inputs
        lengthSlider.addEventListener('input', (e) => {
            lengthInput.value = e.target.value;
            generatePassword();
        });

        lengthInput.addEventListener('input', (e) => {
            let val = parseInt(e.target.value, 10);
            if (val < 4) val = 4;
            if (val > 128) val = 128;
            
            lengthSlider.value = val;
            if(!isNaN(val)) generatePassword();
        });

        lengthInput.addEventListener('blur', (e) => {
            let val = parseInt(e.target.value, 10);
            if (isNaN(val) || val < 4) e.target.value = 4;
            if (val > 128) e.target.value = 128;
            lengthSlider.value = e.target.value;
            generatePassword();
        });

        // Ensure at least one checkbox is always checked
        function enforceCheckboxSelection(changedElement) {
            const anyChecked = chkUpper.checked || chkLower.checked || chkNumbers.checked || chkSymbols.checked;
            if (!anyChecked) {
                changedElement.checked = true; // Re-check the one they just unchecked
            } else {
                generatePassword();
            }
        }

        chkUpper.addEventListener('change', (e) => enforceCheckboxSelection(e.target));
        chkLower.addEventListener('change', (e) => enforceCheckboxSelection(e.target));
        chkNumbers.addEventListener('change', (e) => enforceCheckboxSelection(e.target));
        chkSymbols.addEventListener('change', (e) => enforceCheckboxSelection(e.target));

        generateBtn.addEventListener('click', generatePassword);

        // Copy functionality
        copyBtn.addEventListener('click', () => {
            const passwordToCopy = display.textContent;
            if (passwordToCopy === "Generating...") return;

            navigator.clipboard.writeText(passwordToCopy).then(() => {
                // Visual feedback
                display.classList.add('copied');
                
                const originalHtml = copyBtn.innerHTML;
                copyBtn.innerHTML = `
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--strength-strong)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                `;
                
                setTimeout(() => {
                    display.classList.remove('copied');
                    copyBtn.innerHTML = originalHtml;
                }, 2000);
            });
        });

        // --- 7. INITIALIZATION ---
        generatePassword();

    </script>
</body>
</html>
